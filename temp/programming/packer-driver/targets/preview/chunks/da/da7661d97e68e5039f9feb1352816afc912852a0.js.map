{"version":3,"sources":["file:///Users/abhishekrawat/Desktop/ImageSlicerViewer-sliceAnim/assets/scripts/resourceLoader.ts"],"names":["_decorator","Component","Node","resources","Prefab","instantiate","SpriteFrame","Sprite","ImageAsset","UITransform","AudioSource","GamePlay","glowing","SoundManager","SingletonClass","ResourceUtils","ccclass","property","resourceLoader","type","inc","btn","img","ImageSlide","result","glowInstantiate","child","soundsObj","soundManager","load","prevImage","canPlayMusic","stopWinMusic","boolSound","playSoundEffect","getInstance","getMusicFile","active","destroy","resetImage","getComponent","setImageforSlice","imageArray","addGlow","nextImage","console","log","length","addSlider","end","endPrefab","bg","node","getChildByName","addChild","pos","nextBtn","grayscale","glowPrefab","createWithImage","blink","sprite","maskContent","imageRect","_rect","height","width","start","initAudioSource","musicFiles","init","musicAudioSource","initSoundEffectAS","soundAudioSource","initWinSound","winSound","handleStartButtonClick","loading","getImages","imageSlicer","setSelectedImage","loadDir","err","item","resetBtn","on","imageI","update"],"mappings":"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","sourcesContent":["import { _decorator, Component, Node, resources, Prefab, instantiate, director, SpriteFrame, Sprite, Texture2D, ImageAsset, SystemEvent, Input, Scene, SceneAsset, Vec3, UITransform, JsonAsset, AudioClip, AudioSource } from \"cc\";\nimport { GamePlay } from \"./gamePlay\";\nimport { glowing } from \"./glowing\";\nimport { SoundManager } from \"./managers/soundManager\";\nimport { SingletonClass } from \"./singleTon\";\nimport { ResourceUtils } from \"./managers/resourceUtils\"\nconst { ccclass, property } = _decorator;\n\n@ccclass(\"resourceLoader\")\nexport class resourceLoader extends Component {\n\n    @property({type   : Prefab})\n    imageSlicer : Prefab = null;\n    @property({type   : Prefab})\n    loading : Prefab = null;\n    @property({type   : Prefab})\n    endPrefab : Prefab = null;\n    @property({type   : Prefab})\n    settingMenu : Prefab = null;\n\n   @property({type: Prefab})\n   imageArray : ImageAsset[] =[];\n   inc : number =1;\n\n   @property({type: Prefab})\n   glowPrefab: Prefab = null;\n    btn:Node=null\n    img : any = null;\n    ImageSlide : Node = null;\n    result: Boolean = false\n    glowInstantiate:Node=null;\n    child : Node = null;\n    soundsObj:any=null;\n    soundManager:any=null;\n    load:Node=null\n    @property(Node) musicAudioSource: Node = null;\n    @property(Node) soundAudioSource: Node = null;\n    @property(Node) winSound:Node=null;\n\n    start() {\n        \n        this.initAudioSource();\n        this.soundsObj= SingletonClass.getInstance();\n        this.soundManager = SoundManager.getInstance();\n        ResourceUtils.getInstance().musicFiles();\n    }\n    initAudioSource() {\n        SoundManager.getInstance().init(this.musicAudioSource.getComponent(AudioSource)!);\n        SoundManager.getInstance().initSoundEffectAS(this.soundAudioSource.getComponent(AudioSource)!);\n        SoundManager.getInstance().initWinSound(this.winSound.getComponent(AudioSource)!);\n    }\n    handleStartButtonClick (){\n        \n        if(!this.soundsObj.boolSound){\n            \n            this.soundManager.playSoundEffect( ResourceUtils.getInstance().getMusicFile(\"sound\"),false);\n        }\n        \n        this.child=this.node.getChildByName(\"Node\");  \n        this.btn=this.child.getChildByName('Button');\n        this.btn.active=false;\n        this.load=instantiate(this.loading);\n        this.node.addChild(this.load);\n        this.getImages();    \n    }\n    addSlider(){\n        this.load.destroy();\n        this.result = false\n        this.child.active = false\n        this.ImageSlide = instantiate(this.imageSlicer);\n        this.node.addChild(this.ImageSlide)\n        this.setSelectedImage()\n         \n    }\n    getImages(){\n\n        \n        resources.loadDir('images', ImageAsset, (err, item) => {\n            if (err) {\n                console.log(\"ERROR IN LOADING\");\n            } else {\n                this.imageArray =item;\n                console.log('Array length',item.length)\n                this.addSlider();\n            }\n        });\n    }\n    \n    setSelectedImage(){\n            let nextBtn = this.ImageSlide.getChildByName('nextImage');\n            let resetBtn = this.ImageSlide.getChildByName('resetImage');\n            let prevImage = this.ImageSlide.getChildByName('prevImage');\n           \n            prevImage.on('click', this.prevImage, this)\n            resetBtn.on('click', this.resetImage,this)\n            nextBtn.on('click',this.nextImage,this);\n            let imageI = SpriteFrame.createWithImage(this.imageArray[this.inc]);\n            console.log(this.imageArray[this.inc]);\n            this.ImageSlide.getComponent(GamePlay).setImageforSlice(this.imageArray[this.inc],this.inc,this.addGlow);\n        }\n        \n        prevImage = () =>{\n            this.soundManager.canPlayMusic=false;\n            this.soundManager.stopWinMusic();\n            if(!this.soundsObj.boolSound){\n            \n                this.soundManager.playSoundEffect( ResourceUtils.getInstance().getMusicFile(\"sound\"),false);\n            }\n            this.btn.active=true;\n            this.load.destroy();\n            this.ImageSlide.destroy();\n            this.child.active = true\n            this.inc=0\n\n        }\n        resetImage = () => {\n            this.soundManager.canPlayMusic=false;\n            this.soundManager.stopWinMusic();\n            if(!this.soundsObj.boolSound){\n            \n                this.soundManager.playSoundEffect( ResourceUtils.getInstance().getMusicFile(\"sound\"),false);\n            }\n            if(this.result){\n            this.glowInstantiate.destroy();\n            }\n            \n           this.ImageSlide.getComponent(GamePlay).setImageforSlice(this.imageArray[this.inc],this.inc,this.addGlow);\n        }\n        nextImage = () =>{\n\n            this.soundManager.canPlayMusic=false;\n            this.soundManager.stopWinMusic();\n            console.log(\"Next Image button\")\n            if(this.inc<this.imageArray.length-1){\n                if(this.result){\n                    ++this.inc\n                    this.ImageSlide.destroy();\n                    this.addSlider();\n                }\n            } else{\n                console.log(\"END OF ARRAY\")\n                this.ImageSlide.destroy();\n                let end = instantiate(this.endPrefab)\n                let bg = this.node.getChildByName('Node')\n                bg.active = true\n                bg.addChild(end)\n            }\n        }\n        addGlow = (result : Boolean, pos : Vec3) =>{\n                this.result = result;\n                let nextBtn = this.ImageSlide.getChildByName(\"nextImage\")\n                    nextBtn.getComponent(Sprite).grayscale = false\n                    this.glowInstantiate = instantiate(this.glowPrefab);\n                    this.img= SpriteFrame.createWithImage(this.imageArray[this.inc])\n                    this.glowInstantiate.getComponent(glowing).blink(this.img)\n                    let sprite = this.glowInstantiate.getChildByName('Item_cat');\n                    let maskContent = this.glowInstantiate.getChildByName('Mask');\n                    this.ImageSlide.addChild(this.glowInstantiate);\n                    // this.glowInstantiate.setPosition(0, pos.y, 0);\n                   let imageRect = this.img._rect;\n                    sprite.getComponent(UITransform).height = imageRect.height;\n                    sprite.getComponent(UITransform).width = imageRect.width;\n                    maskContent.getComponent(UITransform).height = imageRect.height;\n                    maskContent.getComponent(UITransform).width = imageRect.width;\n                }\n\n\n\n                update(){\n                    if(this.soundsObj.boolSound){\n                    this.soundManager.canPlayMusic=false;\n                    this.soundManager.stopWinMusic();\n                    }\n                }\n        }\n"]}